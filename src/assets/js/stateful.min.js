(function(f){"use strict";var u=f,r=f.jQuery,v={root:f.document};function o(i){this.settings=r.extend({},v,i),this.init()}var l=function(s){return typeof s<"u"},c=function(s){return s.is("[data-st8-show-if-set], [data-st8-hide-if-set], [data-st8-show-if-value], [data-st8-hide-if-value], [data-st8-show-unless-value], [data-st8-hide-unless-value]")},h=function(s){return s.is("[data-st8-show-if-set], [data-st8-hide-if-set], [data-st8-show-if-value], [data-st8-hide-if-value], [data-st8-show-unless-value], [data-st8-hide-unless-value]")},d=function(s,n){var e=s.attr("data-st8-key"),t=s.attr("id");return s.attr("aria-hidden",n?"false":"true"),r('[data-st8-key="'+e+'"][aria-controls]').filter(function(){var a=r(this).attr("aria-controls").split(" ");return a.indexOf(t)>-1}).attr("aria-expanded",n?"true":"false"),s},p=function(s){var n=s.find("body");n.length&&(s=n),s.append('<style type="text/css">[data-st8-key][aria-hidden="true"]{display:none !important;}</style>')};r.extend(o.prototype,{init:function(){var i=this,s=r(i.settings.root),n=0;if(s.data("stateful-init"))return!0;s.data("stateful-init",!0),p(s),r("[data-st8-key]").each(function(){var e=i.getState(),t=r(this),a=t.attr("data-st8-key");if(l(e[a]))return!0;t.is('input[type="radio"], input[type="checkbox"]')?t.prop("checked")&&i.updateState(a,t.val()):t.is("select[multiple]")?t.val()&&i.updateState(a,t.val()):t.is("input, textarea, select")&&t.val()&&i.updateState(a,t.val())}),r("[data-st8-key]").each(function(){var e=r(this),t=e.attr("data-st8-key");if(h(e)){var a=e.attr("id")||"st8-conditional-"+(n+1);a=""+a,e.attr("id",a),r('[data-st8-key="'+t+'"]').filter("input, textarea, select").each(function(){r(this).attr("aria-controls")?r(this).attr("aria-controls",r(this).attr("aria-controls")+" "+a):r(this).attr("aria-controls",""+a)})}}),s.on("change","[data-st8-key]",function(){var e=r(this),t=e.attr("data-st8-key");if(e.is('input[type="radio"], input[type="checkbox"]'))e.prop("checked")?i.updateState(t,e.val()):i.updateState(t);else if(e.is("input, textarea, select")){var a=e.val();a?i.updateState(t,a):i.updateState(t)}i.applyState(t)}),i.applyState()},getState:function(i){var s=this,n=JSON.parse(u.localStorage.getItem("state")||"{}");return l(i)?n[i]:n},updateState:function(i,s){var n=this,e=n.getState();l(s)?e[i]=s:delete e[i],u.localStorage.setItem("state",JSON.stringify(e))},clearState:function(){var i=this;u.localStorage.setItem("state","{}")},applyState:function(i){var s=this,n="[data-st8-key]";typeof i=="string"&&(n='[data-st8-key="'+i+'"]'),r(n).each(function(){var e=s.getState(),t=r(this),a=t.attr("data-st8-key");if(t.is('input[type="radio"], input[type="checkbox"]')){var y=l(e[a])&&e[a]==t.val();t.prop("checked",y)}else t.is("select[multiple]")||t.is("input, textarea, select")?t.val(e[a]?e[a]:null):c(t)||t.text(e[a]?e[a]:"");t.is("[data-st8-show-if-set]")?d(t,l(e[a])):t.is("[data-st8-hide-if-set]")?d(t,!l(e[a])):t.is("[data-st8-show-if-value]")?d(t,e[a]==t.attr("data-st8-show-if-value")):t.is("[data-st8-hide-if-value]")?d(t,e[a]!=t.attr("data-st8-hide-if-value")):t.is("[data-st8-show-unless-value]")?d(t,e[a]!=t.attr("data-st8-show-unless-value")):t.is("[data-st8-hide-unless-value]")&&d(t,e[a]==t.attr("data-st8-hide-unless-value"))})}}),u.Stateful=o})(window);
